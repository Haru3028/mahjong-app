# 麻雀アプリ（役計算・練習・一覧・履歴・何切る）

## 概要
麻雀の役判定・点数計算だけでなく、計算練習・役一覧・点数表・何切る問題・履歴など多機能を備えたWebアプリです。

- **Next.js + React + TypeScript** SPA
- **Ruby製APIサーバ**で役判定・点数計算
- **赤ドラ全領域1枚制限/同一牌4枚制限/リアルなバリデーション**
- **役一覧・ダブル役満・点数表・練習・何切る・履歴**
- **レスポンシブUI・全牌画像表示**

---

## 目次
1. [主な機能一覧](#主な機能一覧)
2. [各ページの説明・使い方](#各ページの説明・使い方)
3. [バリデーション仕様](#バリデーション仕様)
4. [技術スタック・構成](#技術スタック・構成)
5. [開発・起動方法](#開発・起動方法)
6. [トラブルシューティング](#トラブルシューティング)
7. [FAQ](#faq)

---

## 主な機能一覧
- **計算機**: 牌・ドラ・フーロ・場情報を入力し役判定・点数計算
- **計算練習**: ランダム問題で点数計算力を鍛える（答え合わせ・解説付き）
- **履歴**: 過去の計算や練習・クイズの履歴を保存・再確認
- **役一覧**: 1翻役～役満・ダブル役満まで全役を解説付きで表示
- **点数表**: 子/親・符/翻ごとの点数早見表
- **一覧メニュー**: 役一覧・点数表へのナビゲーション
- **ダッシュボード**: 全機能へのメインメニュー

---

## 各ページの説明・使い方

### 1. ダッシュボード（トップメニュー）
- `/` でアクセス。全機能（計算機・練習・何切る・履歴・一覧）への入口。

### 2. 計算機
- 牌・ドラ・フーロ・場情報をクリックで入力
- 赤5萬・赤5筒・赤5索は全体で1枚まで、同一牌は手牌＋ドラで4枚まで自動制限
- 鳴き（ポン・チー・カン）も追加可能
- 「計算」ボタンで役・点数・詳細を表示

### 3. 計算練習
- `/keisanrenshu` でアクセス
- ランダムな点数計算問題が出題され、手牌・ドラを入力して答え合わせ
- 入力もバリデーション（赤ドラ・同一牌制限）あり
- 正解・解説表示、繰り返し練習可能

### 4. 履歴
- `/history` でアクセス
- 計算・練習・クイズの履歴を自動保存
- 過去の入力・結果・解説を再確認可能

### 5. 一覧メニュー
- `/list` でアクセス
- 「役一覧」「点数表」へのナビゲーション

### 6. 役一覧
- `/yaku-list` でアクセス
- 1翻役～役満・ダブル役満まで全役を解説付きで表示
- 翻数ごとにタブ切替、ダブル役満は別枠

### 7. 点数表
- `/score-table` でアクセス
- 子/親・符/翻ごとの点数早見表を表形式で表示

---

## バリデーション仕様
- 赤ドラ（赤5萬・赤5筒・赤5索）は全領域（手牌・ドラ・フーロ）で1枚まで
- 同一牌は手牌＋ドラ表示牌で最大4枚まで
- 牌の合計は14枚まで
- 鳴き（フーロ）も枚数制限に含む
- UI・ロジック両方で制限

---

## 技術スタック・構成
- **フロントエンド**: Next.js 15.x, React 19, TypeScript, TailwindCSS
- **バックエンド**: Ruby 3.2系 + WEBrick (APIサーバ)
- **状態管理**: React Hooks
- **画像**: `/public/tiles/` 以下に全牌画像
- **主なディレクトリ**:
  - `src/app/` ... ページ・UI
  - `src/components/` ... UIコンポーネント
  - `src/data/mahjongTiles.ts` ... 牌データ
  - `src/hooks/` ... ロジック・状態管理
  - `src/types/` ... 型定義
  - `src/utils/` ... 役判定・点数計算ロジック
  - `ruby_backend/` ... Ruby APIサーバ

---

## 開発・起動方法
1. 依存パッケージのインストール
   ```bash
   npm install
   ```
2. 開発サーバー起動
   ```bash
   npm run dev
   ```
3. ブラウザで `http://localhost:3000` を開く

---

## トラブルシューティング
- 画像が表示されない → `/public/tiles/`ディレクトリに画像ファイルがあるか確認
- コンポーネントがレンダリングされない → ブラウザの開発者ツールでエラーを確認
- スタイルが適用されない → TailwindCSSの設定を確認
- ポート競合時 → `npm run setup:ports` で自動解放

---

## FAQ
- **Q. 赤ドラは何枚まで？**
  - A. 萬子・筒子・索子の5に各1枚、全領域で1枚まで
- **Q. 同じ牌は何枚まで？**
  - A. 手牌＋ドラ表示牌で最大4枚まで
- **Q. 鳴きはどうやって追加？**
  - A. 「ポン」「チー」「カン」ボタンで候補を選択し、確定
- **Q. 役一覧はどこ？**
  - A. メニューの一覧ボタンから一覧画面に遷移
- **Q. 練習や何切るの履歴は見れる？**
  - A. 履歴ページで過去の記録を確認可能

---
ご意見・ご要望はIssueまたはPRでお知らせください。

## 開発・起動方法
1. 依存パッケージのインストール
   ```bash
   npm install
   ```
2. 開発サーバー起動
   ```bash
   npm run dev
   ```
3. ブラウザで `http://localhost:3000` を開く

## トラブルシューティング
- 画像が表示されない → `/public/tiles/`ディレクトリに画像ファイルがあるか確認
- コンポーネントがレンダリングされない → ブラウザの開発者ツールでエラーを確認
- スタイルが適用されない → TailwindCSSの設定を確認
- ポート競合時 → `npm run setup:ports` で自動解放

## よくある質問
- **Q. 赤ドラは何枚まで？**
  - A. 萬子・筒子・索子の5に各1枚、全領域で1枚まで
- **Q. 同じ牌は何枚まで？**
  - A. 手牌＋ドラ表示牌で最大4枚まで
- **Q. 鳴きはどうやって追加？**
  - A. 「ポン」「チー」「カン」ボタンで候補を選択し、確定
- **Q. 役一覧はどこ？**
  - A. メニューまたは「役一覧」ボタンから遷移

---
ご意見・ご要望はIssueまたはPRでお知らせください。
